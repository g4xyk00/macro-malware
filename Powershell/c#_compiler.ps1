$cp = New-Object System.CodeDom.Compiler.CompilerParameters
$cp.GenerateInMemory = $true
$cp.ReferencedAssemblies.AddRange(@("System.dll", [PsObject].Assembly.Location))
$code = @"
public class App
{
	public static void Main(){
		System.Diagnostics.Process.Start("calc.exe");
	}
}
"@
$provider = [System.CodeDom.Compiler.CodeDomProvider]::CreateProvider("CSharp").CompileAssemblyFromSource($cp, $code)
$instance = $provider.CompiledAssembly.CreateInstance("App")
$instance.GetType().GetMethod("Main").Invoke($instance, $null)